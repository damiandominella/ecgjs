var EcgJs=function(a){'use strict';var b="undefined"==typeof globalThis?"undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?{}:self:global:window:globalThis,c=function(a,b){return b={exports:{}},a(b,b.exports),b.exports}(function(a,c){var d=b&&b.__assign||function(){return d=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a},d.apply(this,arguments)};c.__esModule=!0;var e=function(){function a(a,b,c,e,f){void 0===e&&(e={}),void 0===f&&(f={}),this.X_MIN=0,this.X_MAX=3e3,this.Y_MIN=1.12,this.Y_MAX=1.17,console.log("[ecgjs] INIT"),this.$plotly=b,this.elementId=a,this.data=c,this.fullGraph={x:this.data.x,y:this.data.y,name:"Full ECG",mode:"lines"},this.setDefaults(),this.config=d(d({},this.config),e),this.layout=d(d({},this.layout),f),this.index=0,this.originalSpeed=1,this.speed=this.originalSpeed,this.isPlaying=!1,this.annotations=[]}return a.prototype.plot=function(){console.log("[ecgjs] PLOT"),this.$plotly.newPlot(this.elementId,[{x:[],y:[],name:"EcgJs",mode:"lines"}],this.layout,this.config)},a.prototype.reset=function(){console.log("[ecgjs] RESET"),this.setDefaults(),this.hideFull(),this.pause();for(var a=document.getElementById(this.elementId);0<a.data.length;)this.$plotly.deleteTraces(this.elementId,[0]);this.index=0,this.clearNotes(),this.plot()},a.prototype.clearNotes=function(){console.log("[ecgjs] CLEAR_NOTES"),this.annotations=[],this.$plotly.relayout(this.elementId,{annotations:[]})},a.prototype.addNote=function(a,b){var c={text:a,x:b.points[0].x,y:parseFloat(b.points[0].y.toPrecision(4)),font:{size:14,color:"#333"},ax:20,ay:-30,borderpad:2,bgcolor:"#FFEC8B",opacity:.9};this.annotations=this.layout.annotations||[],this.annotations.push(c),this.$plotly.relayout(this.elementId,{annotations:this.annotations})},a.prototype.play=function(){var a=this;this.isPlaying||(console.log("[ecgjs] PLAY"),this.hideFull(),this.isPlaying=!0,this.interval=setInterval(function(){for(var b=[a.data.x[a.index]],c=[a.data.y[a.index]],d=a.originalSpeed;d<a.speed;d++)b.push(a.data.x[a.index+d]),c.push(a.data.y[a.index+d]);a.$plotly.extendTraces(a.elementId,{x:[b],y:[c]},[0]),a.index+a.speed===a.data.x.length-1?clearInterval(a.interval):a.index+=a.speed;var e=!1;if(a.data.x[a.index]>a.X_MAX/2){e=!0;var f=a.data.x[a.index]-a.X_MAX/2,g=f+a.X_MAX;a.xRange=[f,g]}!e||a.updateRange()},10))},a.prototype.pause=function(){this.isPlaying&&(console.log("[ecgjs] PAUSE"),!!this.interval&&(this.isPlaying=!1,clearInterval(this.interval)))},a.prototype.changeSpeed=function(a){console.log("[ecgjs] CHANGE_SPEED"),this.speed=this.originalSpeed*a},a.prototype.updateRange=function(a,b){console.log("[ecgjs] UPDATE_RANGE"),!a||(this.xRange=a),!b||(this.yRange=b),this.$plotly.relayout(this.elementId,{"xaxis.range":this.xRange,"yaxis.range":this.yRange})},a.prototype.showFull=function(){this.isFullShowing||(console.log("[ecgjs] SHOW_FULL"),this.pause(),this.isFullShowing=!0,this.$plotly.addTraces(this.elementId,this.fullGraph))},a.prototype.hideFull=function(){!this.isFullShowing||(console.log("[ecgjs] HIDE_FULL"),this.isFullShowing=!1,this.$plotly.deleteTraces(this.elementId,[1]))},a.prototype.setDefaults=function(){this.setDefaultRanges(),this.layout={title:"EcgJs",height:500,colorway:["#000"],annotations:this.annotations,xaxis:{title:"Time (ms)",range:this.xRange,fixedrange:!1,showline:!0,showgrid:!0,gridcolor:"#ff0202",tickmode:"linear",dtick:200},yaxis:{title:"Amplitude (mV)",range:this.yRange,fixedrange:!1,showline:!0,showgrid:!0,gridcolor:"#ff0202",tickmode:"linear",dtick:.005}},this.config={responsive:!0,scrollZoom:!1,displayModeBar:!0,showlegend:!1,modeBarButtonsToRemove:["autoScale2d"]}},a.prototype.setDefaultRanges=function(){this.xRange=[this.X_MIN,this.X_MAX],this.yRange=[this.Y_MIN,this.Y_MAX]},a}();c.init=function(a,b){var c=new e(a,b.plotly,b.data,b.config,b.layout);return c.plot(),c}}),d=function(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a["default"]:a}(c),e=c.init;return a.default=d,a.init=e,a}({});
//# sourceMappingURL=ecg.min.js.map
